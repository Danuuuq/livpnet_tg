from collections import defaultdict

class CommonMessage:
    """–û–±—â–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è: –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è, FAQ –∏ –¥—Ä."""

    HELLO_FOR_CLIENT = (
        'üëã–° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º, {name}!\n–¢–≤–æ—è –ø–æ–¥–ø–∏—Å–∫–∞ –∞–∫—Ç–∏–≤–Ω–∞ –¥–æ: {end_data:.10}\n'
        '–ú—ã –Ω–∞–ø–æ–º–Ω–∏–º —Ç–µ–±–µ –∑–∞ –¥–µ–Ω—å –¥–æ –æ–∫–æ–Ω—á–∞–Ω–∏—è –ø–æ–¥–ø–∏—Å–∫–∏, –∞ –ø–æ–∫–∞ '
        '–Ω–∞—Å–ª–∞–∂–¥–∞–π—Å—è —Å–≤–æ–±–æ–¥–æ–π –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ, –∏–ª–∏ –≤—ã–±–µ—Ä–∏ –¥–µ–π—Å—Ç–≤–∏—è:')
    HELLO_WITHOUT_SUB = (
        'üëã–ü—Ä–∏–≤–µ—Ç, {name}!\nüòî–£ —Ç–µ–±—è –ø–æ–∫–∞ –Ω–µ—Ç –ø–æ–¥–ø–∏—Å–∫–∏\n'
        '–û—Ñ–æ—Ä–º–ª—è–π —Å–µ–±–µ –ø–æ–¥–ø–∏—Å–∫—É –∏ –ø—Ä–∏–≥–ª–∞—à–∞–π –¥—Ä—É–∑–µ–π\n'
        '–≤–µ–¥—å –∑–∞ –¥—Ä—É–∑–µ–π –º—ã –¥–∞–µ–º –±–æ–Ω—É—Å—ã (–¥–µ–Ω—å–≥–∏):')
    REFERRAL_MESSAGE = (
        'üöÄ –í–æ—Ç —Ç–≤–æ—è –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–∞—è —Å—Å—ã–ª–∫–∞ –Ω–∞ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ: '
        '[–Ω–∞–∂–º–∏ –Ω–∞ —Å—Å—ã–ª–∫—É –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è] '
        '<code>https://t.me/livpnet_bot?start={user_id}</code>\n'
        '–°–∫–æ—Ä–æ —Ç—É—Ç –±—É–¥–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–≤–æ–µ–º –±–∞–ª–∞–Ω—Å–µ\n'
        '–û—Ç–ø—Ä–∞–≤–ª—è–π —Å—Å—ã–ª–∫—É –¥—Ä—É–∑—å—è–º –∏ –ø–æ–ª—É—á–∏ 100 —Ä—É–±–ª–µ–π üíµ\n'
        '–ë–æ–Ω—É—Å –ø–æ–ª—É—á–∏—à—å, –∫–æ–≥–¥–∞ –¥—Ä—É–≥ –æ–ø–ª–∞—Ç—è—Ç –ø–æ–¥–ø–∏—Å–∫—É.üòä\n'
        '–í—ã–≤–æ–¥ —Å—Ä–µ–¥—Å—Ç–≤ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–∞–ø—Ä–æ—Å–∏—Ç—å —á–µ—Ä–µ–∑ –ø–æ–¥–¥–µ—Ä–∂–∫—É üëá')
    SUBSCRIPTION_WELCOME = (
        '–í –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç —É —Ç–µ–±—è –Ω–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ–π –ø–æ–¥–ø–∏—Å–∫–∏.ü§∑‚Äç‚ôÇÔ∏è\n'
        '–ê –∑–Ω–∞—á–∏—Ç –º–æ–∂–µ—à—å –ø–æ–ª—É—á–∏—Ç—å –µ—ë –±–µ—Å–ø–ª–∞—Ç–Ω–æ!üçæ\n'
        '–õ–∏–±–æ —Å—Ä–∞–∑—É –æ–ø–ª–∞—Ç–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É.‚ù§Ô∏è')
    SUBSCRIPTION_INFO = (
        '–¢–≤–æ—è –ø–æ–¥–ø–∏—Å–∫–∞ –∞–∫—Ç–∏–≤–Ω–∞ –¥–æ: {end_date:.10}\n'
        '–¢–≤–æ–π —Ç–µ–∫—É—â–∏–π –ø–ª–∞–Ω –ø–æ–¥–ø–∏—Å–∫–∏: {type}\n')
    BAD_CREATE_TRIAL_SUB = (
        '–£ —Ç–µ–±—è —É–∂–µ –±—ã–ª –ø—Ä–æ–±–Ω—ã–π –ø–µ—Ä–∏–æ–¥ –∏–ª–∏ –ø–æ–¥–ø–∏—Å–∫–∞ üôà\n'
        '–•–æ—á–µ—à—å –±–µ—Å–ø–ª–∞—Ç–Ω–æ? –ü—Ä–∏–≥–ª–∞—à–∞–π –¥—Ä—É–∑–µ–π –∏ –ø–æ–ª—É—á–∞–π –±–æ–Ω—É—Å—ã üßë‚Äçü§ù‚Äçüßë\n'
        '–ê –ø–æ–∫–∞ –º–æ–∂–µ–º –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å –æ–ø–ª–∞—Ç–∏—Ç—å —Ç–µ–∫—É—â—É—é üòè:')
    PRICE_MESSAGE = (
        '<b>üíº –¢–∞—Ä–∏—Ñ—ã –Ω–∞ –ø–æ–¥–ø–∏—Å–∫—É:</b>\n\n'
        '<b>üîπ 2 —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞:</b>\n'
        '‚Ä¢ 1 –º–µ—Å—è—Ü ‚Äî <b>250 ‚ÇΩ</b>\n'
        '‚Ä¢ 6 –º–µ—Å—è—Ü–µ–≤ ‚Äî <b>1 400 ‚ÇΩ</b>\n'
        '‚Ä¢ 1 –≥–æ–¥ ‚Äî <b>2 700 ‚ÇΩ</b>\n\n'
        '<b>üî∏ 4 —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞:</b>\n'
        '‚Ä¢ 1 –º–µ—Å—è—Ü ‚Äî <b>450 ‚ÇΩ</b>\n'
        '‚Ä¢ 6 –º–µ—Å—è—Ü–µ–≤ ‚Äî <b>2 500 ‚ÇΩ</b>\n'
        '‚Ä¢ 1 –≥–æ–¥ ‚Äî <b>4 800 ‚ÇΩ</b>\n\n'
        '–í—ã–±–µ—Ä–∏—Ç–µ —É–¥–æ–±–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç –∏ –æ—Ñ–æ—Ä–º–∏—Ç–µ –ø–æ–¥–ø–∏—Å–∫—É üëá')
    URL_FOR_PAY = (
        '<b>üí≥ –û–ø–ª–∞—Ç–∞ –ø–æ–¥–ø–∏—Å–∫–∏</b>\n\n'
        '–û–ø–ª–∞—Ç–∏—Ç–µ –ø–æ–¥–ø–∏—Å–∫—É –ø–æ —Å—Å—ã–ª–∫–µ –Ω–∏–∂–µ:\n\n'
        '<a href=\'{payment_link}\'>üëâ –ü–µ—Ä–µ–π—Ç–∏ –∫ –æ–ø–ª–∞—Ç–µ</a>\n\n'
        '–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –æ–ø–ª–∞—Ç—ã –ø—Ä–æ–≤–µ—Ä—è–π —Å–≤–æ–∏ –ø–æ–¥–ø–∏—Å–∫–∏.'
    )
    URL_WITH_HELP = {
        'openvpn': {
            'windows': 'https://telegra.ph/OpenVPN-na-Windows-05-17',
            'macos': 'https://telegra.ph/OpenVPN-na-MacOS-05-17',
            'android': 'https://telegra.ph/OpenVPN-na-Android-05-17',
            'iphone': 'https://telegra.ph/OpenVPN-na-Iphone-05-17'
        },
        'vless': {
            'windows': 'https://telegra.ph/Vless-na-Windows-05-17',
            'macos': 'https://telegra.ph/Vless-na-MacOS-05-17',
            'android': 'https://telegra.ph/Vless-na-Adnroid-05-17',
            'iphone': 'https://telegra.ph/Vless-na-Iphone-05-17'
        }
    }
    LOAD_MSG_SUB = '–ó–∞–≥—Ä—É–∂–∞—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–¥–ø–∏—Å–∫–µ'
    LOAD_MSG_TRIAL_SUB = '–û—Ñ–æ—Ä–º–ª—è–µ–º –ø—Ä–æ–±–Ω—É—é –ø–æ–¥–ø–∏—Å–∫—É'
    LOAD_MSG_KEYS = '–ù–∞—á–∏–Ω–∞—é –∑–∞–≥—Ä—É–∑–∫—É –∫–ª—é—á–µ–π'
    LOAD_MSG_REF = '–ó–∞–≥—Ä—É–∂–∞—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –ø–æ —Ä–µ—Ñ–µ—Ä–∞–º'
    LOAD_MSG_PRICE = '–ó–∞–≥—Ä—É–∂–∞—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –ø–æ —Ü–µ–Ω–∞–º'
    LOAD_MSG_FAQ = '–ó–∞–≥—Ä—É–∂–∞—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏'
    LOAD_MSG_SUPPORT = '–ü–µ—Ä–µ–≤–æ–∂—É –Ω–∞ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫—É—é –ø–æ–¥–¥–µ—Ä–∂–∫—É'
    LOAD_MSG_CHOICE_SUB = '–ù–∞—á–∏–Ω–∞–µ–º –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–∏'
    CHOICE_MSG_FAQ_DEVICE = '–í—ã–±–µ—Ä–∏—Ç–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ:'
    CHOICE_MSG_PROTOCOL = '–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ—Ç–æ–∫–æ–ª –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:'
    CHOICE_MSG_NEW_OR_OLD = '–ü—Ä–æ–¥–ª–µ–≤–∞–µ–º –∏–ª–∏ –º–µ–Ω—è–µ–º –ø–æ–¥–ø–∏—Å–∫—É?'
    CHOICE_MSG_TYPE_SUB = '–í—ã–±–µ—Ä–∏ –≤–∞—Ä–∏–∞–Ω—Ç –ø–æ–¥–ø–∏—Å–∫–∏:'
    CHOICE_MSG_LOCATION = '–í—ã–±–µ—Ä–∏ –ª–æ–∫–∞—Ü–∏—é –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:'
    CHOICE_MSG_DURATION = '–í—ã–±–µ—Ä–∏ –Ω–∞ –∫–∞–∫–æ–π —Å—Ä–æ–∫ –æ—Ñ–æ—Ä–º–∏—à—å –ø–æ–¥–ø–∏—Å–∫—É:'
    MSG_FOR_UPDATE_SUB = (
        '–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø–æ–¥–ø–∏—Å–∫–∏\n'
        '—Å—Ç–∞—Ä–∞—è –æ—Å—Ç–∞–Ω–µ—Ç—Å—è –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ–π –¥–æ –∫–æ–Ω—Ü–∞ —Å—Ä–æ–∫–∞ –¥–µ–π—Å—Ç–≤–∏—è\n'
        '–í—ã–±–µ—Ä–∏ –≤–∞—Ä–∏–∞–Ω—Ç –ø–æ–¥–ø–∏—Å–∫–∏:')
    MSG_FOR_TROUBLE = '–†–∞—Å—Å–∫–∞–∂–∏ –æ —Å–≤–æ–µ–π –ø—Ä–æ–±–ª–µ–º–µ, '
    MSG_WITHOUT_SUB = '–£ —Ç–µ–±—è –ø–æ–∫–∞ —á—Ç–æ –Ω–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–¥–ø–∏—Å–æ–∫:'
    MSG_FOR_OVPN = '–°–∫–∞—á–∏–≤–∞–π, –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–π –∏ –ø–æ–¥–∫–ª—é—á–∞–π—Å—è:'
    MSG_FOR_VLESS = ('–°–∫–∞–Ω–∏—Ä—É–π QR-–∫–æ–¥ –∏–ª–∏ –∫–æ–ø–∏—Ä—É–π —Å—Å—ã–ª–∫—É: '
                     '<code>{url}</code>')

    @staticmethod
    def format_price_message(tariffs: list[dict]) -> str:
        grouped = defaultdict(list)
        for item in tariffs:
            grouped[item["type"]].append((item["duration"], item["price"]))

        parts = ['<b>üíº –¢–∞—Ä–∏—Ñ—ã –Ω–∞ –ø–æ–¥–ø–∏—Å–∫—É:</b>\n']
        for i, (device_type, options) in enumerate(grouped.items()):
            bullet = "üîπ" if i % 2 == 0 else "üî∏"
            parts.append(f'\n<b>{bullet} {device_type}:</b>')
            for duration, price in options:
                parts.append(f'‚Ä¢ {duration} ‚Äî <b>{price} ‚ÇΩ</b>')
        parts.append('\n\n–í—ã–±–µ—Ä–∏—Ç–µ —É–¥–æ–±–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç –∏ –æ—Ñ–æ—Ä–º–∏—Ç–µ –ø–æ–¥–ø–∏—Å–∫—É üëá')
        return '\n'.join(parts)


class Keyboards:
    """–¢–µ–∫—Å—Ç –¥–ª—è –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã"""

    SUBSCRIPTION = 'üîê –¢–≤–æ—è –ø–æ–¥–ø–∏—Å–∫–∞'
    REFERRAL = 'üéÅ –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å—Å—ã–ª–∫–∞'
    PRICE = 'üí∞ –°—Ç–æ–∏–º–æ—Å—Ç—å –ø–æ–¥–ø–∏—Å–æ–∫'
    HELP = 'üÜò –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞'
    PAY = 'üí≥ –ü–æ–∫—É–ø–∫–∞'
    KEY = 'üîê –ö–ª—é—á–∏ –∫ VPN'
    TRIAL = 'üÜì –ü—Ä–æ–±–Ω–∞—è –ø–æ–¥–ø–∏—Å–∫–∞'
    RETURN = 'üîô –í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –º–µ–Ω—é'
    TWO_DEVICE = '2Ô∏è‚É£ 2 —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞'
    FOUR_DEVICE = '4Ô∏è‚É£ 4 —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞'
    ONE_MONTH = '1Ô∏è‚É£ 1 –º–µ—Å—è—Ü'
    SIX_MONTH = '6Ô∏è‚É£ 6 –º–µ—Å—è—Ü–µ–≤'
    TWELVE_MONTH = '1Ô∏è‚É£2Ô∏è‚É£ 12 –º–µ—Å—è—Ü–µ–≤'
    VLESS = '‚û∞ Vless'
    OVPN = 'üß± OpenVPN'
    EXTENSION = '‚è≠Ô∏è –ü—Ä–æ–¥–ª–µ–≤–∞–µ–º'
    UPDATE = 'üîÅ –û–±–Ω–æ–≤–ª—è–µ–º'
    WINDOWS = 'ü™ü Windows'
    MAX = 'üçè Mac'
    ANDROID = 'ü§ñ Android'
    IPHONE = 'üçè Iphone'
    SUPPORT = 'üÜò –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞'
